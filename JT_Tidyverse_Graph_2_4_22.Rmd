---
title: "Managing Data and Creating a Graph in Tidyverse"
author: "Jackson Turner"
date: "2/4/2022"
output: 
  html_document
---

This R markdown file provides a brief tutorial on how to visualize some data using tidyverse. 

For this exercise, we'll be using data from a project I contributed to in 2018 to create a preliminary figure demonstrating how soil microbial communities of several sites near and within the Great Smoky Mountains National Park respond along a wildfire burn gradient (high, medium, and none) and human development (natural v. urban). 

## Loading in tidyverse and our data

Because we'll be using ggplot2, dplyr, and tidyr to visualize our data, we'll go ahead and load the tidyverse package that contains all three. Some of the functions will conflict with each other but it won't affect our analysis.


```{r load-packages,warning=FALSE, echo=FALSE}
library(tidyverse)
```

We'll also go ahead and load in our data and save it as a data frame.
```{r, results='hide'}
smokies_dat<-read.csv("Smokies_2019_ENV.csv")
```

Let's use tidyverse to get a sneak peek at our data frame. It's worth noting that each row in this output frame corresponds to a column in our data frame. 
```{r}
glimpse(smokies_dat)
```

Oh no! The first column of our data looks strange!

The columns saved weirdly when this file was buildin Excel, so we'll make the first column our row names instead using the `row.names()` function. Now that our row names are the same as our first column, we'll go ahead and delete that column to make our data concise.
```{r, results='hide'}
row.names(smokies_dat)<-smokies_dat[,1]
smokies_dat<-smokies_dat[,-1]
```

How does our data look now?
```{r, evaluate=TRUE}
glimpse(smokies_dat)
```

There, our data are now ready to explore!


## Subsetting our data

Oh no! The botanist who's quality checking our samples just called, and they said that the violets we sampled were actually cardboard cuttouts! 

We can't include them in the data anymore since there was no plant in those samples to affect microbial diversity. Therefore, we'll have to remove each row of our data set that corresponds to a violet (with the `PlantSpecies` code `VIOL`). Tidyverse makes this easy by allowing us to filter out all the cardboard cuttouts we mistook for violets in our data.
```{r, results='hide'}
(smokies_dat<-smokies_dat %>%
  filter(PlantSpecies!="VIOL"))
```

Now that we've compensated for our mistake, let's go ahead and remove any empty or duplicated rows of data.
```{r, results='hide'}
smokies_dat %>%
  na.omit() %>%
  distinct()
```

It looks like our data is in order. To make this analysis easy on ourselves, we'll go ahead and subset it, creating a smaller data frame with only the information we need to answer our question: `UN` (development), `Burn.Status` (burn status), and `Shannon` (Shannon diversity).
```{r, results='hide'}
smokies_dat_subset<- smokies_dat %>%
  select(UN,Burn.Status,Shannon)
```

Now that we've checked and subset our data, we're ready to visualise our relevant data!

## Visualising our data

The `ggplot2` package within `tidyverse` allows us to plot our data in any way of our choosing. For this particular graph, we'd like to use a boxplot with human development on the X-axis, Shannon diversity on the Y-axis, and a seperate boxplot for each burn status.
```{r pressure, echo=TRUE}
ggplot(smokies_dat_subset,aes(x=UN,y=Shannon,fill=Burn.Status)) +
  geom_boxplot() +
  xlab("Development Status") +
  ylab("Shannon Divsersity") +
  labs(fill="Burn Status")+
  theme(panel.border = element_rect(linetype = "solid", fill = NA),
        panel.background = element_blank(),
        axis.title = element_text(face = "plain", color = "black", size = 18),
        axis.text.y = element_text(face = "plain", color = "black", size = 10),
        axis.text.x = element_text(face = "plain", color = "black", size = 10),
        axis.line.y = element_line(size = 0.5),
        axis.line.x = element_line(size = 0.5),
        legend.title=element_text(size=16),
        legend.text=element_text(size=20))
```


From this exploratory graph we can infer that natural, unburned sites in this system are somewhat more diverse than those of urban sites or those that have been affected by wildfires. Despite the inferences provided by this graph, this is just an exploratory graph and is under no circumstances a substitute for actual analyses used to answer our question. 


This concludes the tutorial -- I hope it was helpful and I wish you the best in your journey creating graphs! 